
# This file was generated by the Tkinter Designer by Parth Jadhav
# https://github.com/ParthJadhav/Tkinter-Designer


from pathlib import Path

# from tkinter import *
# Explicit imports to satisfy Flake8
from tkinter import Tk, Canvas, Entry, Text, Button, PhotoImage

import subprocess
import sys

OUTPUT_PATH = Path(__file__).parent
ASSETS_PATH = OUTPUT_PATH / Path(r"G:/My Drive/Coding\DigitalQuizApp/quiz_gui\build/assets/frame2")

# --- FUNCTIONS ---

def relative_to_assets(path: str) -> Path:
    return ASSETS_PATH / Path(path)

def restart_quiz(event):
    window.destroy()
    python_executable = sys.executable
    subprocess.Popen([python_executable, "quiz_gui/build/gui.py"])

window = Tk()

window.geometry("1440x1024")
window.configure(bg = "#3D3C3C")

# --- IU ---

canvas = Canvas(
    window,
    bg = "#3D3C3C",
    height = 1024,
    width = 1440,
    bd = 0,
    highlightthickness = 0,
    relief = "ridge"
)

canvas.place(x = 0, y = 0)

message_text = canvas.create_text(
    720.0,
    341.0,
    anchor="n",
    text="Final Score",
    fill="#FFFFFF",
    font=("Consolas", 40 * -1)
)

canvas.create_text(
    720.0,
    62.0,
    anchor="n",
    text="ðŸŽ‰Quiz Complete!ðŸŽ‰",
    fill="#FFFFFF",
    font=("Consolas", 64 * -1)
)

# text to display final score
score_text = canvas.create_text(
    720.0,
    434.0,
    anchor="n",
    text="You Answered 8/10 Questions Correct!",
    fill="#FFFFFF",
    font=("Consolas", 40 * -1)
)

# Restart Button 
restart_rect = canvas.create_rectangle(
    520.0,
    703.0,
    920.0,
    823.0,
    fill="#746FF4",
    outline=""
)
restart_text = canvas.create_text(
    720.0,
    763.0,
    anchor="center",
    text="Restart",
    fill="#FFFFFF",
    font=("Consolas", 40 * -1)
)
canvas.tag_bind(restart_rect, "<Button-1>", restart_quiz)
canvas.tag_bind(restart_text, "<Button-1>", restart_quiz)

# --- Load and Display Final Score
try: 
    with open("score.txt", "r") as f:
        score_data = f.read().split(',')
        score = score_data[0].strip()
        total = score_data[1].strip()

        # converting numbvers into floats
        score_num = float(score)
        total_num = float(total)

        # calculating the percentages
        percentage = 0.0
        if total_num > 0:
            percentage = (score_num / total_num) * 100

        # creating new score string & updating the message
        final_score_str = f"You Answered {score}/{total} Questions Correct!"
        canvas.itemconfig(score_text, text=final_score_str)

        if  percentage == 100:
            canvas.itemconfig(message_text, text="A genius upon us!")
        elif percentage >= 80:
            canvas.itemconfig(message_text, text="You are quite smart!")
        elif percentage >= 45:
            canvas.itemconfig(message_text, text="You probably should read a book...")
        else:
            canvas.itemconfig(message_text, text="Are you an American citizen??")

except FileNotFoundError:
    print("Error: score.txt not found.")
    # if file not found display a default error
    canvas.itemconfig(score_text, text="Error: Could not find score")

except Exception as e:
    print(f"An error occured {e}")
    canvas.itemconfig(score_text, text="Error: Could not read score.")

window.resizable(True, True)
window.mainloop()